{% extends "admin/base_site.html" %}
{% load i18n static %}{% load admin_menu %}

{% block extrastyle %}{{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static "admin/css/dashboard.css" %}"/>{% endblock %}
    
{% block coltype %}colMS{% endblock %}

{% block bodyclass %}{{ block.super }} dashboard{% endblock %}

{% block breadcrumbs %}{% endblock %}

{% block content %}
    <div id="content-main">
        <div class="row">
            <div class="col-md-3 col-sm-6 col-xs-12">
              <div class="info-box">
                <span class="info-box-icon bg-aqua"><i class="fa fa-tasks"></i></span>
    
                <div class="info-box-content">
                  <span class="info-box-text">Purchase Request</span>
                  <span class="info-box-number">15</span>
                </div>
                <!-- /.info-box-content -->
              </div>
              <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
              <div class="info-box">
                <span class="info-box-icon bg-red"><i class="fa fa-file"></i></span>
    
                <div class="info-box-content">
                  <span class="info-box-text">RFQ</span>
                  <span class="info-box-number">65</span>
                </div>
                <!-- /.info-box-content -->
              </div>
              <!-- /.info-box -->
            </div>
            <!-- /.col -->
    
            <!-- fix for small devices only -->
            <div class="clearfix visible-sm-block"></div>
    
            <div class="col-md-3 col-sm-6 col-xs-12">
              <div class="info-box">
                <span class="info-box-icon bg-green"><i class="fa fa-folder-open"></i></span>
    
                <div class="info-box-content">
                  <span class="info-box-text">Purchase Quotation</span>
                  <span class="info-box-number">54</span>
                </div>
                <!-- /.info-box-content -->
              </div>
              <!-- /.info-box -->
            </div>
            <!-- /.col -->
            <div class="col-md-3 col-sm-6 col-xs-12">
              <div class="info-box">
                <span class="info-box-icon bg-yellow"><i class="fa fa-inbox"></i></span>
    
                <div class="info-box-content">
                  <span class="info-box-text">Purchase Order</span>
                  <span class="info-box-number">119</span>
                </div>
                <!-- /.info-box-content -->
              </div>
              <!-- /.info-box -->
            </div>
            <!-- /.col -->
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="box">
                <div class="box-header with-border">
                  <h3 class="box-title">Monthly Recap Report</h3>
    
                  <div class="box-tools pull-right">
                    <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                    </button>
                  </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                  <div class="row">
                    <div class="col-md-12">
                      <p class="text-center">
                        <strong>Sales: 1 Jan, 2020 - 29 Feb, 2020</strong>
                      </p>
    
                      <div class="chart">
                        <!-- Sales Chart Canvas -->
                        <canvas id="salesChart" style="height: 180px; width: 703px;" height="180" width="703"></canvas>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
                        <script>
                            var MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                            var config = {
                                type: 'line',
                                data: {
                                    labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
                                    datasets: [{
                                        label: 'PR',
                                        data: [
                                            10, 5, 8, 28, 19, 35, 71
                                        ],
                                        fill: false,
                                        borderColor: [
                                            'rgba(54, 162, 235, 1)'
                                        ],
                                    }, {
                                        label: 'PO',
                                        fill: false,
                                        data: [
                                            40,29,18,18,39,29,11
                                        ],
                                        borderColor: [
                                            'rgba(255, 99, 132, 1)'
                                        ],
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    title: {
                                        display: true,
                                        text: 'PR vs PO'
                                    },
                                    tooltips: {
                                        mode: 'index',
                                        intersect: false,
                                    },
                                    hover: {
                                        mode: 'nearest',
                                        intersect: true
                                    },
                                    scales: {
                                        xAxes: [{
                                            display: true,
                                            scaleLabel: {
                                                display: true,
                                                labelString: 'Month'
                                            }
                                        }],
                                        yAxes: [{
                                            display: true,
                                            scaleLabel: {
                                                display: true,
                                                labelString: 'Value'
                                            }
                                        }]
                                    }
                                }
                            };
                    
                            window.onload = function() {
                                var ctx = document.getElementById('salesChart').getContext('2d');
                                window.myLine = new Chart(ctx, config);
                            };
                    
                            document.getElementById('randomizeData').addEventListener('click', function() {
                                config.data.datasets.forEach(function(dataset) {
                                    dataset.data = dataset.data.map(function() {
                                        return randomScalingFactor();
                                    });
                    
                                });
                    
                                window.myLine.update();
                            });
                    
                            var colorNames = Object.keys(window.chartColors);
                            document.getElementById('addDataset').addEventListener('click', function() {
                                var colorName = colorNames[config.data.datasets.length % colorNames.length];
                                var newColor = window.chartColors[colorName];
                                var newDataset = {
                                    label: 'Dataset ' + config.data.datasets.length,
                                    backgroundColor: newColor,
                                    borderColor: newColor,
                                    data: [],
                                    fill: false
                                };
                    
                                for (var index = 0; index < config.data.labels.length; ++index) {
                                    newDataset.data.push(randomScalingFactor());
                                }
                    
                                config.data.datasets.push(newDataset);
                                window.myLine.update();
                            });
                    
                            document.getElementById('addData').addEventListener('click', function() {
                                if (config.data.datasets.length > 0) {
                                    var month = MONTHS[config.data.labels.length % MONTHS.length];
                                    config.data.labels.push(month);
                    
                                    config.data.datasets.forEach(function(dataset) {
                                        dataset.data.push(randomScalingFactor());
                                    });
                    
                                    window.myLine.update();
                                }
                            });
                    
                            document.getElementById('removeDataset').addEventListener('click', function() {
                                config.data.datasets.splice(0, 1);
                                window.myLine.update();
                            });
                    
                            document.getElementById('removeData').addEventListener('click', function() {
                                config.data.labels.splice(-1, 1); // remove the label first
                    
                                config.data.datasets.forEach(function(dataset) {
                                    dataset.data.pop();
                                });
                    
                                window.myLine.update();
                            });
                        </script>
                      </div>
                      <!-- /.chart-responsive -->
                    </div>
                    
                  <!-- /.row -->
                </div>
                <div class="row">
                    <div class="col-sm-4 col-xs-6">
                      <div class="description-block border-right">
                        <span class="description-percentage text-green"><i class="fa fa-caret-up"></i> 17%</span>
                        <h5 class="description-header">RM35,210.43</h5>
                        <span class="description-text">TOTAL REVENUE</span>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                    <div class="col-sm-4 col-xs-6">
                      <div class="description-block border-right">
                        <span class="description-percentage text-yellow"><i class="fa fa-caret-left"></i> 0%</span>
                        <h5 class="description-header">RM10,390.90</h5>
                        <span class="description-text">TOTAL COST</span>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                    <div class="col-sm-4 col-xs-6">
                      <div class="description-block border-right">
                        <span class="description-percentage text-green"><i class="fa fa-caret-up"></i> 20%</span>
                        <h5 class="description-header">RM24,813.53</h5>
                        <span class="description-text">TOTAL PROFIT</span>
                      </div>
                      <!-- /.description-block -->
                    </div>
                  </div>
                  <!-- /.row -->
              </div>
              <!-- /.box -->
            </div>
    </div>
{% endblock %}

{% block sidebar %}
    <div id="content-related">
        <div class="module" id="recent-actions-module">
            <h2>{% trans 'Recent actions' %}</h2>
            <h3>{% trans 'My actions' %}</h3>
            {% load log %}
            {% get_admin_log 10 as admin_log for_user user %}
            {% if not admin_log %}
                <p>{% trans 'None available' %}</p>
            {% else %}
                <ul class="actionlist">
                    {% for entry in admin_log %}
                        <li class="{% if entry.is_addition %}addlink{% endif %}{% if entry.is_change %}changelink{% endif %}{% if entry.is_deletion %}deletelink{% endif %}">
                            {% if entry.is_deletion or not entry.get_admin_url %}
                                {{ entry.object_repr }}
                            {% else %}
                                <a href="{{ entry.get_admin_url }}">{{ entry.object_repr }}</a>
                            {% endif %}
                            <br/>
                            {% if entry.content_type %}
                                <span class="mini quiet">{% filter capfirst %}
                                    {{ entry.content_type }}{% endfilter %}</span>
                            {% else %}
                                <span class="mini quiet">{% trans 'Unknown content' %}</span>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
    </div>
{% endblock %}
